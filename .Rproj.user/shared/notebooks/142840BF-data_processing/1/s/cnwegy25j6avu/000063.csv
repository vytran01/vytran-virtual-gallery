"0","library(ggplot2)"
"0",""
"0","# Group the data by team and player, and count the number of goals each player contributes to each team"
"0","goals_contribution <- aggregate(Gls ~ Team + Player, data = df_with_goals, FUN = sum)"
"0","goals_contribution <- goals_contribution[order(goals_contribution$Team, -goals_contribution$Gls), ]"
"0",""
"0","plot_list <- list()"
"0",""
"0","# Create a pie chart for each team"
"0","for(team in unique(goals_contribution$Team)) {"
"0","  # Subset the data for the current team"
"0","  team_data <- subset(goals_contribution, Team == team)"
"0","  top_players <- head(team_data, 5)"
"0","  other_goals <- sum(team_data$Gls) - sum(top_players$Gls)"
"0","  other_data <- data.frame(Team = team, Player = ""Other"", Gls = other_goals)"
"0","  "
"0","  pie_data <- rbind(top_players, other_data)"
"0","  "
"0","  # Create the pie chart"
"0","  pie_chart <- ggplot(pie_data, aes(x = """", y = Gls, fill = Player)) +"
"0","    geom_bar(stat = ""identity"") +"
"0","    geom_text(aes(label = paste0(round((Gls / sum(pie_data$Gls)) * 100), ""%"")),"
"0","              position = position_stack(vjust = 0.5), size = 4) + "
"0","    coord_polar(""y"", start = 0) +"
"0","    labs(fill = ""Player"") +"
"0","    ggtitle(paste(""Goal contribution of"", team, ""players"")) +"
"0","    theme_void()"
"0","  "
"0","  plot_list[[team]] <- pie_chart"
"0","}"
"0",""
