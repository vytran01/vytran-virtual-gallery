"0","# total goals by team"
"0","goals_by_team <- aggregate(Gls ~ Team, df, sum, na.rm = TRUE)"
"0","# penalty goals by team"
"0","pk_by_team <- aggregate(PK ~ Team, df, sum, na.rm = TRUE)"
"0","# free kick goals by team"
"0","fk_by_team <- aggregate(FK ~ Team, df, sum, na.rm = TRUE)"
"0",""
"0","df_team <- merge(goals_by_team, pk_by_team, by = ""Team"", all = TRUE)"
"0","df_team <- merge(df_team, fk_by_team, by = ""Team"", all = TRUE)"
"0","df_team['OtherGls'] = df_team['Gls'] - df_team['PK'] - df_team['FK']"
"0",""
"0","goal_types <- df_team[, c(""Team"", ""PK"", ""FK"", ""OtherGls"")]"
"0",""
"0","df_melt <- melt(goal_types, id.vars = ""Team"")"
"0","ggplot(df_melt, aes(Team, value, fill = variable)) +"
"0","  geom_bar(position = ""fill"", stat = ""identity"") +"
"0","  scale_y_continuous(labels = percent) +"
"0","  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +"
"0","  labs(x = ""Team"", y = ""Percentage of Goals"", title = ""Distribution of Goal Types Across Teams"")"
